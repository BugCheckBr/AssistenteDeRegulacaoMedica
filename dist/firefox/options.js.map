{"version":3,"file":"options.js","mappings":"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","sources":["webpack://assistente-de-regulacao-medica/./options.js","webpack://assistente-de-regulacao-medica/webpack/bootstrap","webpack://assistente-de-regulacao-medica/webpack/runtime/chunk loaded","webpack://assistente-de-regulacao-medica/webpack/runtime/define property getters","webpack://assistente-de-regulacao-medica/webpack/runtime/hasOwnProperty shorthand","webpack://assistente-de-regulacao-medica/webpack/runtime/make namespace object","webpack://assistente-de-regulacao-medica/webpack/runtime/jsonp chunk loading","webpack://assistente-de-regulacao-medica/webpack/before-startup","webpack://assistente-de-regulacao-medica/webpack/startup","webpack://assistente-de-regulacao-medica/webpack/after-startup"],"sourcesContent":["import * as API from './api.js'; // Importa a API para buscar prioridades\r\nimport './browser-polyfill.js';\r\nimport { defaultFieldConfig } from './field-config.js';\r\nimport { filterConfig } from './filter-config.js';\r\nimport * as Utils from './utils.js';\r\n\r\n// --- Constantes ---\r\nconst CONFIG_VERSION = '1.3'; // Versão da estrutura de configuração\r\n\r\n// --- Variáveis de Estado ---\r\nlet automationRules = [];\r\nlet currentlyEditingRuleId = null;\r\nlet draggedTab = null; // Variável para a aba arrastada\r\n\r\n// --- Elementos do DOM ---\r\nconst saveButton = document.getElementById('saveButton');\r\nconst statusMessage = document.getElementById('statusMessage');\r\nconst closeButton = document.getElementById('closeButton');\r\nconst restoreDefaultsButton = document.getElementById('restoreDefaultsButton');\r\nconst exportButton = document.getElementById('exportButton');\r\nconst importFileInput = document.getElementById('import-file-input');\r\n\r\n// Ficha do Paciente\r\nconst mainFieldsZone = document.getElementById('main-fields-zone');\r\nconst moreFieldsZone = document.getElementById('more-fields-zone');\r\n\r\n// Abas e Zonas de Filtros Manuais\r\nconst allDropZones = document.querySelectorAll('.drop-zone');\r\n\r\n// --- Elementos do DOM para o Gerenciador de Automação ---\r\nconst automationRulesList = document.getElementById('automation-rules-list');\r\nconst createNewRuleBtn = document.getElementById('create-new-rule-btn');\r\nconst ruleEditorModal = document.getElementById('rule-editor-modal');\r\nconst ruleEditorTitle = document.getElementById('rule-editor-title');\r\nconst ruleNameInput = document.getElementById('rule-name-input');\r\nconst ruleTriggersInput = document.getElementById('rule-triggers-input');\r\nconst cancelRuleBtn = document.getElementById('cancel-rule-btn');\r\nconst saveRuleBtn = document.getElementById('save-rule-btn');\r\n\r\n/**\r\n * Cria um elemento de campo arrastável para a Ficha do Paciente.\r\n * @param {object} field - O objeto de configuração do campo.\r\n * @returns {HTMLElement} O elemento <div> do campo.\r\n */\r\nfunction createDraggableField(field) {\r\n  const div = document.createElement('div');\r\n  div.className = 'draggable';\r\n  div.dataset.fieldId = field.id;\r\n  div.draggable = true;\r\n\r\n  div.innerHTML = `\r\n    <span class=\"drag-handle\">⠿</span>\r\n    <input type=\"checkbox\" class=\"field-enabled-checkbox\" ${\r\n  field.enabled ? 'checked' : ''\r\n}>\r\n    <input type=\"text\" class=\"field-label-input\" value=\"${field.label}\">\r\n  `;\r\n\r\n  div.addEventListener('dragstart', handleDragStart);\r\n  div.addEventListener('dragend', handleDragEnd);\r\n\r\n  return div;\r\n}\r\n\r\n/**\r\n * Cria um elemento de filtro arrastável com controlos para valor padrão.\r\n * @param {object} filter - O objeto de configuração do filtro.\r\n * @param {Array<object>} priorities - A lista de prioridades dinâmicas para a regulação.\r\n * @returns {HTMLElement} O elemento <div> do filtro.\r\n */\r\nfunction createDraggableFilter(filter, priorities = []) {\r\n  const div = document.createElement('div');\r\n  div.className = 'draggable';\r\n  div.dataset.filterId = filter.id;\r\n  div.draggable = true;\r\n\r\n  const displayType = filter.type === 'selectGroup' ? 'select' : filter.type;\r\n\r\n  let defaultValueControl = '';\r\n  if (filter.type !== 'component') {\r\n    switch (filter.type) {\r\n    case 'text': {\r\n      defaultValueControl =\r\n          '<input type=\"text\" class=\"filter-default-value-input w-full\" placeholder=\"Valor padrão...\">';\r\n      break;\r\n    }\r\n    case 'select':\r\n    case 'selectGroup': {\r\n      let optionsHtml = '';\r\n      if (filter.id === 'regulation-filter-priority') {\r\n        // Constrói o dropdown de prioridades dinamicamente\r\n        optionsHtml = filter.options\r\n          .map((opt) => `<option value=\"${opt.value}\">${opt.text}</option>`)\r\n          .join(''); // Adiciona \"Todas\"\r\n        priorities.forEach((prio) => {\r\n          optionsHtml += `<option value=\"${prio.coreDescricao}\">${prio.coreDescricao}</option>`;\r\n        });\r\n      } else {\r\n        // Lógica original para outros selects\r\n        optionsHtml = (filter.options || [])\r\n          .map((opt) => `<option value=\"${opt.value}\">${opt.text}</option>`)\r\n          .join('');\r\n      }\r\n      defaultValueControl = `<select class=\"filter-default-value-input w-full\">${optionsHtml}</select>`;\r\n      break;\r\n    }\r\n    case 'checkbox': {\r\n      defaultValueControl =\r\n          '<input type=\"checkbox\" class=\"filter-default-value-input h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500\">';\r\n      break;\r\n    }\r\n    }\r\n  }\r\n\r\n  div.innerHTML = `\r\n    <span class=\"drag-handle\">⠿</span>\r\n    <div class=\"flex-grow flex flex-col gap-2\">\r\n        <div class=\"flex justify-between items-center\">\r\n            <span class=\"font-medium text-sm\">${filter.label}</span>\r\n            <span class=\"text-xs text-slate-400 p-1 bg-slate-100 rounded\">${displayType}</span>\r\n        </div>\r\n        ${\r\n  defaultValueControl\r\n    ? `\r\n        <div class=\"flex items-center gap-2 text-xs text-slate-500\">\r\n            <label for=\"default-${filter.id}\">Padrão:</label>\r\n            ${defaultValueControl.replace(\r\n    'class=\"',\r\n    `id=\"default-${filter.id}\" class=\"`\r\n  )}\r\n        </div>`\r\n    : ''\r\n}\r\n    </div>\r\n  `;\r\n\r\n  if (filter.type === 'component') {\r\n    div.classList.add('draggable-component');\r\n  }\r\n\r\n  div.addEventListener('dragstart', handleDragStart);\r\n  div.addEventListener('dragend', handleDragEnd);\r\n\r\n  return div;\r\n}\r\n\r\n/**\r\n * Renderiza os campos da Ficha do Paciente nas zonas corretas.\r\n * @param {Array<object>} config - A configuração de campos.\r\n */\r\nfunction renderPatientFields(config) {\r\n  mainFieldsZone.innerHTML = '';\r\n  moreFieldsZone.innerHTML = '';\r\n\r\n  const sortedConfig = [...config].sort((a, b) => a.order - b.order);\r\n\r\n  sortedConfig.forEach((field) => {\r\n    const fieldElement = createDraggableField(field);\r\n    if (field.section === 'main') {\r\n      mainFieldsZone.appendChild(fieldElement);\r\n    } else {\r\n      moreFieldsZone.appendChild(fieldElement);\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * Renderiza os filtros de seção nas zonas corretas e define seus valores padrão.\r\n * @param {object} layout - A configuração de layout dos filtros.\r\n */\r\nasync function renderFilterLayout(layout) {\r\n  let priorities = [];\r\n\r\n  try {\r\n    const baseUrl = await API.getBaseUrl();\r\n    if (baseUrl) {\r\n      priorities = await API.fetchRegulationPriorities();\r\n    }\r\n  } catch (error) {\r\n    console.error('Não foi possível carregar prioridades:', error);\r\n  }\r\n\r\n  Object.keys(filterConfig).forEach((section) => {\r\n    const mainZone = document.getElementById(`${section}-main-filters-zone`);\r\n    const moreZone = document.getElementById(`${section}-more-filters-zone`);\r\n    if (mainZone) mainZone.innerHTML = '';\r\n    if (moreZone) moreZone.innerHTML = '';\r\n  });\r\n\r\n  Object.entries(filterConfig).forEach(([sectionKey, filters]) => {\r\n    const sectionLayout = layout[sectionKey] || [];\r\n    const layoutMap = new Map(sectionLayout.map((f) => [f.id, f]));\r\n\r\n    const sortedFilters = [...filters].sort((a, b) => {\r\n      const orderA = layoutMap.get(a.id)?.order ?? Infinity;\r\n      const orderB = layoutMap.get(b.id)?.order ?? Infinity;\r\n      return orderA - orderB;\r\n    });\r\n\r\n    sortedFilters.forEach((filter) => {\r\n      const filterLayoutData = layoutMap.get(filter.id);\r\n      const location = filterLayoutData?.location || filter.defaultLocation;\r\n\r\n      if (sectionKey === 'patient-card') return;\r\n      const zoneId = `${sectionKey}-${location}-filters-zone`;\r\n      const zone = document.getElementById(zoneId);\r\n\r\n      if (zone) {\r\n        const filterElement = createDraggableFilter(filter, priorities);\r\n        zone.appendChild(filterElement);\r\n\r\n        if (\r\n          filter.type !== 'component' &&\r\n          filterLayoutData &&\r\n          filterLayoutData.defaultValue !== undefined\r\n        ) {\r\n          const defaultValueInput = filterElement.querySelector(\r\n            '.filter-default-value-input'\r\n          );\r\n          if (defaultValueInput) {\r\n            if (defaultValueInput.type === 'checkbox') {\r\n              defaultValueInput.checked = filterLayoutData.defaultValue;\r\n            } else {\r\n              defaultValueInput.value = filterLayoutData.defaultValue;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Reordena os botões das abas na página de opções com base na ordem salva.\r\n * @param {string[]} order - Array de IDs de abas na ordem correta.\r\n */\r\nfunction applyTabOrder(order) {\r\n  const tabsContainer = document.querySelector('#filter-tabs-container .tabs');\r\n  if (!tabsContainer) return;\r\n\r\n  const tabMap = new Map();\r\n  tabsContainer.querySelectorAll('.tab-button').forEach((tab) => {\r\n    tabMap.set(tab.dataset.tab, tab);\r\n  });\r\n\r\n  // Anexa as abas na ordem salva. As não encontradas na ordem (novas) permanecem.\r\n  order.forEach((tabId) => {\r\n    const tabElement = tabMap.get(tabId);\r\n    if (tabElement) {\r\n      tabsContainer.appendChild(tabElement);\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * Carrega a configuração salva e renderiza a página.\r\n */\r\nasync function restoreOptions() {\r\n  const syncItems = await browser.storage.sync.get({\r\n    baseUrl: '',\r\n    autoLoadExams: false,\r\n    autoLoadConsultations: false,\r\n    autoLoadAppointments: false,\r\n    autoLoadRegulations: false,\r\n    autoLoadDocuments: false,\r\n    enableAutomaticDetection: true,\r\n    keepSessionAliveInterval: 10,\r\n    patientFields: defaultFieldConfig,\r\n    filterLayout: {},\r\n    dateRangeDefaults: {},\r\n    sidebarSectionOrder: null,\r\n    sectionHeaderStyles: {},\r\n  });\r\n\r\n  const localItems = await browser.storage.local.get({\r\n    automationRules: [],\r\n  });\r\n\r\n  document.getElementById('baseUrlInput').value = syncItems.baseUrl || '';\r\n  document.getElementById('enableAutomaticDetection').checked =\r\n    syncItems.enableAutomaticDetection;\r\n  document.getElementById('keepSessionAliveInterval').value =\r\n    syncItems.keepSessionAliveInterval;\r\n  document.getElementById('autoLoadExamsCheckbox').checked =\r\n    syncItems.autoLoadExams;\r\n  document.getElementById('autoLoadConsultationsCheckbox').checked =\r\n    syncItems.autoLoadConsultations;\r\n  document.getElementById('autoLoadAppointmentsCheckbox').checked =\r\n    syncItems.autoLoadAppointments;\r\n  document.getElementById('autoLoadRegulationsCheckbox').checked =\r\n    syncItems.autoLoadRegulations;\r\n  document.getElementById('autoLoadDocumentsCheckbox').checked =\r\n    syncItems.autoLoadDocuments;\r\n\r\n  if (syncItems.sidebarSectionOrder) {\r\n    applyTabOrder(syncItems.sidebarSectionOrder);\r\n  }\r\n\r\n  const currentPatientFieldsConfig = defaultFieldConfig.map((defaultField) => {\r\n    const savedField = syncItems.patientFields.find(\r\n      (f) => f.id === defaultField.id\r\n    );\r\n    return savedField ? { ...defaultField, ...savedField } : defaultField;\r\n  });\r\n  renderPatientFields(currentPatientFieldsConfig);\r\n\r\n  try {\r\n    await renderFilterLayout(syncItems.filterLayout);\r\n  } catch (error) {\r\n    console.error('Erro ao renderizar filtros:', error);\r\n  }\r\n\r\n  const sections = [\r\n    'patient-details',\r\n    'timeline',\r\n    'consultations',\r\n    'exams',\r\n    'appointments',\r\n    'regulations',\r\n    'documents',\r\n  ];\r\n  const defaultRanges = {\r\n    consultations: { start: -6, end: 0 },\r\n    exams: { start: -6, end: 0 },\r\n    appointments: { start: -1, end: 3 },\r\n    regulations: { start: -12, end: 0 },\r\n    documents: { start: -24, end: 0 },\r\n  };\r\n\r\n  // CORREÇÃO 2: Define os estilos padrão aqui.\r\n  const defaultStyles = {\r\n    backgroundColor: '#ffffff',\r\n    color: '#1e293b',\r\n    iconColor: '#1e293b',\r\n    fontSize: '16px',\r\n  };\r\n\r\n  sections.forEach((section) => {\r\n    if (defaultRanges[section]) {\r\n      const range =\r\n        syncItems.dateRangeDefaults[section] || defaultRanges[section];\r\n      const startOffsetEl = document.getElementById(`${section}-start-offset`);\r\n      const endOffsetEl = document.getElementById(`${section}-end-offset`);\r\n      if (startOffsetEl) startOffsetEl.value = Math.abs(range.start);\r\n      if (endOffsetEl) endOffsetEl.value = range.end;\r\n    }\r\n\r\n    // Restaura estilos, usando os padrões como base.\r\n    const savedStyle = syncItems.sectionHeaderStyles[section] || {};\r\n    const style = { ...defaultStyles, ...savedStyle };\r\n\r\n    const bgColorEl = document.getElementById(`style-${section}-bg-color`);\r\n    const fontColorEl = document.getElementById(`style-${section}-font-color`);\r\n    const iconColorEl = document.getElementById(`style-${section}-icon-color`);\r\n    const fontSizeEl = document.getElementById(`style-${section}-font-size`);\r\n\r\n    if (bgColorEl) bgColorEl.value = style.backgroundColor;\r\n    if (fontColorEl) fontColorEl.value = style.color;\r\n    if (iconColorEl) iconColorEl.value = style.iconColor;\r\n    if (fontSizeEl) fontSizeEl.value = style.fontSize;\r\n  });\r\n\r\n  automationRules = localItems.automationRules || [];\r\n  renderAutomationRules();\r\n}\r\n\r\n/**\r\n * Salva as configurações GERAIS (não as regras de automação).\r\n */\r\nasync function saveOptions() {\r\n  const baseUrl = document.getElementById('baseUrlInput').value;\r\n  const enableAutomaticDetection = document.getElementById(\r\n    'enableAutomaticDetection'\r\n  ).checked;\r\n  const keepSessionAliveInterval =\r\n    parseInt(document.getElementById('keepSessionAliveInterval').value, 10) ||\r\n    0;\r\n  const autoLoadExams = document.getElementById(\r\n    'autoLoadExamsCheckbox'\r\n  ).checked;\r\n  const autoLoadConsultations = document.getElementById(\r\n    'autoLoadConsultationsCheckbox'\r\n  ).checked;\r\n  const autoLoadAppointments = document.getElementById(\r\n    'autoLoadAppointmentsCheckbox'\r\n  ).checked;\r\n  const autoLoadRegulations = document.getElementById(\r\n    'autoLoadRegulationsCheckbox'\r\n  ).checked;\r\n  const autoLoadDocuments = document.getElementById(\r\n    'autoLoadDocumentsCheckbox'\r\n  ).checked;\r\n\r\n  const patientFields = [];\r\n  mainFieldsZone.querySelectorAll('.draggable').forEach((div, index) => {\r\n    const fieldId = div.dataset.fieldId;\r\n    const label = div.querySelector('.field-label-input').value;\r\n    const enabled = div.querySelector('.field-enabled-checkbox').checked;\r\n    patientFields.push({\r\n      id: fieldId,\r\n      label,\r\n      enabled,\r\n      section: 'main',\r\n      order: index + 1,\r\n    });\r\n  });\r\n  moreFieldsZone.querySelectorAll('.draggable').forEach((div, index) => {\r\n    const fieldId = div.dataset.fieldId;\r\n    const label = div.querySelector('.field-label-input').value;\r\n    const enabled = div.querySelector('.field-enabled-checkbox').checked;\r\n    patientFields.push({\r\n      id: fieldId,\r\n      label,\r\n      enabled,\r\n      section: 'more',\r\n      order: index + 1,\r\n    });\r\n  });\r\n\r\n  const filterLayout = {};\r\n  document\r\n    .querySelectorAll('#layout-config-section .drop-zone')\r\n    .forEach((zone) => {\r\n      if (!zone.dataset.section) return;\r\n      const section = zone.dataset.section;\r\n      if (!filterLayout[section]) filterLayout[section] = [];\r\n      const location = zone.id.includes('-main-') ? 'main' : 'more';\r\n      zone.querySelectorAll('.draggable').forEach((div, index) => {\r\n        const filterId = div.dataset.filterId;\r\n        const originalFilter = filterConfig[section].find(\r\n          (f) => f.id === filterId\r\n        );\r\n        const newFilterData = {\r\n          id: filterId,\r\n          location: location,\r\n          order: index + 1,\r\n        };\r\n        if (originalFilter.type !== 'component') {\r\n          const defaultValueInput = div.querySelector(\r\n            '.filter-default-value-input'\r\n          );\r\n          if (defaultValueInput) {\r\n            newFilterData.defaultValue =\r\n              defaultValueInput.type === 'checkbox'\r\n                ? defaultValueInput.checked\r\n                : defaultValueInput.value;\r\n          }\r\n        }\r\n        filterLayout[section].push(newFilterData);\r\n      });\r\n    });\r\n\r\n  const dateRangeDefaults = {};\r\n  const sectionsForDate = [\r\n    'consultations',\r\n    'exams',\r\n    'appointments',\r\n    'regulations',\r\n    'documents',\r\n  ];\r\n  sectionsForDate.forEach((section) => {\r\n    const startEl = document.getElementById(`${section}-start-offset`);\r\n    const endEl = document.getElementById(`${section}-end-offset`);\r\n    if (startEl && endEl) {\r\n      const start = -parseInt(startEl.value, 10) || 0;\r\n      const end = parseInt(endEl.value, 10) || 0;\r\n      dateRangeDefaults[section] = { start, end };\r\n    }\r\n  });\r\n\r\n  const sectionHeaderStyles = {};\r\n  const sectionsForStyle = [\r\n    'patient-details',\r\n    'timeline',\r\n    'consultations',\r\n    'exams',\r\n    'appointments',\r\n    'regulations',\r\n    'documents',\r\n  ];\r\n  sectionsForStyle.forEach((section) => {\r\n    const bgColorEl = document.getElementById(`style-${section}-bg-color`);\r\n    if (bgColorEl) {\r\n      // Check if the element exists before accessing properties\r\n      sectionHeaderStyles[section] = {\r\n        backgroundColor: bgColorEl.value,\r\n        color: document.getElementById(`style-${section}-font-color`).value,\r\n        iconColor: document.getElementById(`style-${section}-icon-color`).value,\r\n        fontSize: document.getElementById(`style-${section}-font-size`).value,\r\n      };\r\n    }\r\n  });\r\n\r\n  const sidebarSectionOrder = [\r\n    ...document.querySelectorAll('.tabs .tab-button'),\r\n  ].map((btn) => btn.dataset.tab);\r\n\r\n  await browser.storage.sync.set({\r\n    baseUrl: baseUrl.endsWith('/') ? baseUrl.slice(0, -1) : baseUrl,\r\n    enableAutomaticDetection,\r\n    keepSessionAliveInterval,\r\n    autoLoadExams,\r\n    autoLoadConsultations,\r\n    autoLoadAppointments,\r\n    autoLoadRegulations,\r\n    autoLoadDocuments,\r\n    patientFields,\r\n    filterLayout,\r\n    dateRangeDefaults,\r\n    sidebarSectionOrder,\r\n    sectionHeaderStyles,\r\n  });\r\n\r\n  Utils.showMessage(\r\n    'Configurações salvas! As alterações serão aplicadas ao recarregar o assistente.',\r\n    'success'\r\n  );\r\n\r\n  setTimeout(() => {\r\n    const statusMsg = document.getElementById('statusMessage');\r\n    if (statusMsg) {\r\n      statusMsg.textContent = '';\r\n      statusMsg.className = 'text-sm font-medium';\r\n    }\r\n  }, 4000);\r\n}\r\n\r\n// --- Lógica de Arrastar e Soltar (Drag and Drop) ---\r\nlet draggedElement = null;\r\n\r\nfunction handleDragStart(e) {\r\n  draggedElement = e.target.closest('.draggable, .rule-item');\r\n  if (!draggedElement) return;\r\n  e.dataTransfer.effectAllowed = 'move';\r\n  setTimeout(() => draggedElement.classList.add('dragging'), 0);\r\n}\r\n\r\nfunction handleDragEnd(e) {\r\n  if (!draggedElement) return;\r\n  draggedElement.classList.remove('dragging');\r\n  draggedElement = null;\r\n}\r\n\r\nfunction handleDragOver(e) {\r\n  e.preventDefault();\r\n  e.dataTransfer.dropEffect = 'move';\r\n}\r\n\r\nfunction handleDrop(e) {\r\n  e.preventDefault();\r\n  if (!draggedElement) return;\r\n\r\n  const dropZone = e.target.closest('.drop-zone, #automation-rules-list');\r\n  if (dropZone) {\r\n    const afterElement = getDragAfterElement(dropZone, e.clientY);\r\n    if (afterElement == null) {\r\n      dropZone.appendChild(draggedElement);\r\n    } else {\r\n      dropZone.insertBefore(draggedElement, afterElement);\r\n    }\r\n\r\n    if (dropZone.id === 'automation-rules-list') {\r\n      reorderAutomationRules();\r\n    }\r\n  }\r\n}\r\n\r\nfunction getDragAfterElement(container, y) {\r\n  const draggableElements = [\r\n    ...container.querySelectorAll(\r\n      '.draggable:not(.dragging), .rule-item:not(.dragging)'\r\n    ),\r\n  ];\r\n  return draggableElements.reduce(\r\n    (closest, child) => {\r\n      const box = child.getBoundingClientRect();\r\n      const offset = y - box.top - box.height / 2;\r\n      if (offset < 0 && offset > closest.offset) {\r\n        return { offset: offset, element: child };\r\n      } else {\r\n        return closest;\r\n      }\r\n    },\r\n    { offset: Number.NEGATIVE_INFINITY }\r\n  ).element;\r\n}\r\n\r\n// --- Lógica de Arrastar e Soltar para Abas ---\r\nfunction getDragAfterTab(container, x) {\r\n  const draggableElements = [\r\n    ...container.querySelectorAll('.tab-button:not(.dragging)'),\r\n  ];\r\n  return draggableElements.reduce(\r\n    (closest, child) => {\r\n      const box = child.getBoundingClientRect();\r\n      const offset = x - box.left - box.width / 2;\r\n      if (offset < 0 && offset > closest.offset && child.draggable) {\r\n        return { offset: offset, element: child };\r\n      } else {\r\n        return closest;\r\n      }\r\n    },\r\n    { offset: Number.NEGATIVE_INFINITY }\r\n  ).element;\r\n}\r\n\r\nfunction setupTabDnD(container) {\r\n  if (!container) return;\r\n\r\n  const tabs = container.querySelectorAll('.tab-button');\r\n  tabs.forEach((tab) => {\r\n    if (tab.dataset.tab !== 'patient-card') {\r\n      tab.draggable = true;\r\n    }\r\n  });\r\n\r\n  container.addEventListener('dragstart', (e) => {\r\n    if (e.target.classList.contains('tab-button') && e.target.draggable) {\r\n      draggedTab = e.target;\r\n      setTimeout(() => e.target.classList.add('dragging'), 0);\r\n    }\r\n  });\r\n\r\n  container.addEventListener('dragend', () => {\r\n    if (draggedTab) {\r\n      draggedTab.classList.remove('dragging');\r\n      draggedTab = null;\r\n    }\r\n  });\r\n\r\n  container.addEventListener('dragover', (e) => {\r\n    e.preventDefault();\r\n    if (!draggedTab) return;\r\n\r\n    const afterElement = getDragAfterTab(container, e.clientX);\r\n    if (afterElement) {\r\n      container.insertBefore(draggedTab, afterElement);\r\n    } else {\r\n      container.appendChild(draggedTab);\r\n    }\r\n  });\r\n}\r\n\r\n// --- Lógica para Restaurar Padrões ---\r\nasync function handleRestoreDefaults() {\r\n  const confirmation = window.confirm(\r\n    'Tem certeza de que deseja restaurar todas as configurações de layout e valores padrão? Isto também restaurará a ordem das seções e os estilos dos cabeçalhos. Esta ação não pode ser desfeita.'\r\n  );\r\n  if (confirmation) {\r\n    await browser.storage.sync.remove([\r\n      'patientFields',\r\n      'filterLayout',\r\n      'dateRangeDefaults',\r\n      'enableAutomaticDetection',\r\n      'sidebarSectionOrder',\r\n      'sectionHeaderStyles',\r\n    ]);\r\n    mainFieldsZone.innerHTML = '';\r\n    moreFieldsZone.innerHTML = '';\r\n    window.location.reload();\r\n  }\r\n}\r\n\r\n// --- Lógica de Exportação e Importação ---\r\nasync function handleExport() {\r\n  try {\r\n    const settingsToExport = await browser.storage.sync.get(null);\r\n    settingsToExport.configVersion = CONFIG_VERSION;\r\n    const settingsString = JSON.stringify(settingsToExport, null, 2);\r\n    const blob = new Blob([settingsString], { type: 'application/json' });\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    const date = new Date().toISOString().slice(0, 10);\r\n    a.download = `assistente-regulacao-config-${date}.json`;\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    document.body.removeChild(a);\r\n    URL.revokeObjectURL(url);\r\n    Utils.showMessage('Configurações exportadas com sucesso!', 'success');\r\n  } catch (error) {\r\n    console.error('Erro ao exportar configurações:', error);\r\n    Utils.showMessage('Erro ao exportar configurações.', 'error');\r\n  } finally {\r\n    setTimeout(() => {\r\n      statusMessage.textContent = '';\r\n    }, 3000);\r\n  }\r\n}\r\n\r\nfunction handleImport(event) {\r\n  const file = event.target.files[0];\r\n  if (!file) return;\r\n  const reader = new FileReader();\r\n  reader.onload = async (e) => {\r\n    try {\r\n      const importedSettings = JSON.parse(e.target.result);\r\n      if (!importedSettings.configVersion || !importedSettings.filterLayout) {\r\n        throw new Error('Ficheiro de configuração inválido ou corrompido.');\r\n      }\r\n      if (\r\n        importedSettings.configVersion.split('.')[0] !==\r\n        CONFIG_VERSION.split('.')[0]\r\n      ) {\r\n        const goOn = window.confirm(\r\n          'A versão do ficheiro de configuração é muito diferente da versão da extensão. A importação pode causar erros. Deseja continuar mesmo assim?'\r\n        );\r\n        if (!goOn) return;\r\n      }\r\n      await browser.storage.sync.clear();\r\n      await browser.storage.sync.set(importedSettings);\r\n      restoreOptions();\r\n      Utils.showMessage(\r\n        'Configurações importadas e aplicadas com sucesso!',\r\n        'success'\r\n      );\r\n    } catch (error) {\r\n      console.error('Erro ao importar configurações:', error);\r\n      Utils.showMessage(`Erro ao importar: ${error.message}`, 'error');\r\n    } finally {\r\n      importFileInput.value = '';\r\n      setTimeout(() => {\r\n        statusMessage.textContent = '';\r\n      }, 5000);\r\n    }\r\n  };\r\n  reader.readAsText(file);\r\n}\r\n\r\n// --- LÓGICA PARA O GERENCIADOR DE AUTOMAÇÃO ---\r\n\r\n/**\r\n * Renderiza a lista de regras de automação na UI.\r\n */\r\nfunction renderAutomationRules() {\r\n  automationRulesList.innerHTML = '';\r\n  automationRules.forEach((rule) => {\r\n    const ruleElement = document.createElement('div');\r\n    ruleElement.className = 'rule-item border rounded-lg bg-white p-3';\r\n    ruleElement.dataset.ruleId = rule.id;\r\n    ruleElement.draggable = true;\r\n\r\n    const keywords = rule.triggerKeywords.join(', ');\r\n    const checked = rule.isActive ? 'checked' : '';\r\n\r\n    ruleElement.innerHTML = `\r\n            <div class=\"flex items-center justify-between\">\r\n              <div class=\"flex items-center gap-3\">\r\n                <span class=\"drag-handle cursor-grab text-slate-400\">⠿</span>\r\n                <div>\r\n                  <p class=\"font-semibold text-slate-800\">${rule.name}</p>\r\n                  <p class=\"text-xs text-slate-500\" title=\"${keywords}\">Gatilhos: ${\r\n  keywords.length > 50 ? keywords.substring(0, 50) + '...' : keywords\r\n}</p>\r\n                </div>\r\n              </div>\r\n              <div class=\"flex items-center gap-4\">\r\n                <label class=\"relative inline-flex items-center cursor-pointer\" title=\"${\r\n  rule.isActive ? 'Regra Ativa' : 'Regra Inativa'\r\n}\">\r\n                  <input type=\"checkbox\" class=\"sr-only peer rule-toggle-active\" ${checked}>\r\n                  <div class=\"w-11 h-6 bg-gray-200 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600\"></div>\r\n                </label>\r\n                <button class=\"text-sm font-medium text-blue-600 hover:underline rule-edit-btn\">Editar</button>\r\n                <button class=\"text-sm font-medium text-slate-500 hover:underline rule-duplicate-btn\">Duplicar</button>\r\n                <button class=\"text-sm font-medium text-red-600 hover:underline rule-delete-btn\">Excluir</button>\r\n              </div>\r\n            </div>\r\n        `;\r\n    automationRulesList.appendChild(ruleElement);\r\n  });\r\n\r\n  document.querySelectorAll('.rule-item').forEach((item) => {\r\n    const ruleId = item.dataset.ruleId;\r\n    item\r\n      .querySelector('.rule-edit-btn')\r\n      .addEventListener('click', () => handleEditRule(ruleId));\r\n    item\r\n      .querySelector('.rule-delete-btn')\r\n      .addEventListener('click', () => handleDeleteRule(ruleId));\r\n    item\r\n      .querySelector('.rule-duplicate-btn')\r\n      .addEventListener('click', () => handleDuplicateRule(ruleId));\r\n    item\r\n      .querySelector('.rule-toggle-active')\r\n      .addEventListener('change', (e) =>\r\n        handleToggleRuleActive(ruleId, e.target.checked)\r\n      );\r\n  });\r\n}\r\n\r\n/**\r\n * Salva o array de regras de automação no storage local.\r\n */\r\nasync function saveAutomationRules() {\r\n  await browser.storage.local.set({ automationRules });\r\n  Utils.showMessage('Regras de automação salvas.', 'success');\r\n  setTimeout(() => {\r\n    statusMessage.textContent = '';\r\n  }, 2000);\r\n}\r\n\r\n/**\r\n * Abre o modal do editor de regras, preenchendo-o se uma regra for fornecida.\r\n * @param {string|null} ruleId - O ID da regra a ser editada, ou null para criar uma nova.\r\n */\r\nasync function openRuleEditor(ruleId = null) {\r\n  currentlyEditingRuleId = ruleId;\r\n  await populateRuleEditorFilters();\r\n\r\n  if (ruleId) {\r\n    const rule = automationRules.find((r) => r.id === ruleId);\r\n    if (!rule) return;\r\n    ruleEditorTitle.textContent = 'Editar Regra de Automação';\r\n    ruleNameInput.value = rule.name;\r\n    ruleTriggersInput.value = rule.triggerKeywords.join(', ');\r\n\r\n    Object.entries(rule.filterSettings).forEach(([sectionKey, filters]) => {\r\n      // --- INÍCIO DA CORREÇÃO ---\r\n      // Preenche os filtros de data\r\n      if (filters && filters.dateRange) {\r\n        const { start, end } = filters.dateRange;\r\n        const startOffsetEl = document.getElementById(\r\n          `rule-${sectionKey}-start-offset`\r\n        );\r\n        const endOffsetEl = document.getElementById(\r\n          `rule-${sectionKey}-end-offset`\r\n        );\r\n        if (startOffsetEl && start !== null && !isNaN(start)) {\r\n          startOffsetEl.value = Math.abs(start);\r\n        } else if (startOffsetEl) {\r\n          startOffsetEl.value = '';\r\n        }\r\n        if (endOffsetEl && end !== null && !isNaN(end)) {\r\n          endOffsetEl.value = end;\r\n        } else if (endOffsetEl) {\r\n          endOffsetEl.value = '';\r\n        }\r\n      }\r\n      // --- FIM DA CORREÇÃO ---\r\n\r\n      // Preenche outros filtros\r\n      Object.entries(filters).forEach(([filterId, value]) => {\r\n        if (filterId === 'dateRange') return;\r\n        const element = document.getElementById(\r\n          `rule-${sectionKey}-${filterId}`\r\n        );\r\n        if (element) {\r\n          if (element.type === 'checkbox') {\r\n            element.checked = value;\r\n          } else {\r\n            element.value = value;\r\n          }\r\n        }\r\n      });\r\n    });\r\n  } else {\r\n    ruleEditorTitle.textContent = 'Criar Nova Regra de Automação';\r\n    ruleNameInput.value = '';\r\n    ruleTriggersInput.value = '';\r\n\r\n    // Limpa todos os campos, incluindo os de data\r\n    const sections = [\r\n      'consultations',\r\n      'exams',\r\n      'appointments',\r\n      'regulations',\r\n      'documents',\r\n    ];\r\n    sections.forEach((sectionKey) => {\r\n      const startEl = document.getElementById(\r\n        `rule-${sectionKey}-start-offset`\r\n      );\r\n      const endEl = document.getElementById(`rule-${sectionKey}-end-offset`);\r\n      if (startEl) startEl.value = '';\r\n      if (endEl) endEl.value = '';\r\n    });\r\n\r\n    document\r\n      .querySelectorAll(\r\n        '#rule-editor-modal input[type=\"text\"]:not(.rule-date-range-input), #rule-editor-modal input[type=\"search\"]:not(.rule-date-range-input)'\r\n      )\r\n      .forEach((el) => (el.value = ''));\r\n    document\r\n      .querySelectorAll('#rule-editor-modal input[type=\"checkbox\"]')\r\n      .forEach((el) => (el.checked = false));\r\n    document.querySelectorAll('#rule-editor-modal select').forEach((el) => {\r\n      if (el.options.length > 0) {\r\n        el.value = el.options[0].value;\r\n      }\r\n    });\r\n  }\r\n\r\n  ruleEditorModal.classList.remove('hidden');\r\n}\r\n\r\n/**\r\n * Fecha o modal do editor de regras.\r\n */\r\nfunction closeRuleEditor() {\r\n  ruleEditorModal.classList.add('hidden');\r\n  currentlyEditingRuleId = null;\r\n}\r\n\r\n/**\r\n * Salva a regra (nova ou editada) do modal.\r\n */\r\nfunction handleSaveRule() {\r\n  const name = ruleNameInput.value.trim();\r\n  if (!name) {\r\n    alert('O nome da regra é obrigatório.');\r\n    return;\r\n  }\r\n\r\n  const triggerKeywords = ruleTriggersInput.value\r\n    .split(',')\r\n    .map((k) => k.trim())\r\n    .filter(Boolean);\r\n  const filterSettings = {};\r\n  const sections = [\r\n    'consultations',\r\n    'exams',\r\n    'appointments',\r\n    'regulations',\r\n    'documents',\r\n  ];\r\n\r\n  sections.forEach((sectionKey) => {\r\n    filterSettings[sectionKey] = {};\r\n\r\n    // --- INÍCIO DA CORREÇÃO ---\r\n    // Salva as configurações de data\r\n    const startOffsetEl = document.getElementById(\r\n      `rule-${sectionKey}-start-offset`\r\n    );\r\n    const endOffsetEl = document.getElementById(\r\n      `rule-${sectionKey}-end-offset`\r\n    );\r\n    const startVal = startOffsetEl.value;\r\n    const endVal = endOffsetEl.value;\r\n\r\n    const startNum = parseInt(startVal, 10);\r\n    const endNum = parseInt(endVal, 10);\r\n\r\n    if (!isNaN(startNum) || !isNaN(endNum)) {\r\n      filterSettings[sectionKey].dateRange = {\r\n        start: !isNaN(startNum) ? -startNum : null,\r\n        end: !isNaN(endNum) ? endNum : null,\r\n      };\r\n    }\r\n    // --- FIM DA CORREÇÃO ---\r\n\r\n    // Salva as configurações dos outros filtros\r\n    const sectionFilters = filterConfig[sectionKey] || [];\r\n    sectionFilters.forEach((filter) => {\r\n      if (filter.type === 'component') return;\r\n      const element = document.getElementById(\r\n        `rule-${sectionKey}-${filter.id}`\r\n      );\r\n      if (element) {\r\n        const value =\r\n          element.type === 'checkbox' ? element.checked : element.value;\r\n        filterSettings[sectionKey][filter.id] = value;\r\n      }\r\n    });\r\n  });\r\n\r\n  if (currentlyEditingRuleId) {\r\n    const ruleIndex = automationRules.findIndex(\r\n      (r) => r.id === currentlyEditingRuleId\r\n    );\r\n    if (ruleIndex > -1) {\r\n      automationRules[ruleIndex].name = name;\r\n      automationRules[ruleIndex].triggerKeywords = triggerKeywords;\r\n      automationRules[ruleIndex].filterSettings = filterSettings;\r\n    }\r\n  } else {\r\n    const newRule = {\r\n      id: Date.now().toString(),\r\n      name,\r\n      triggerKeywords,\r\n      isActive: true,\r\n      filterSettings,\r\n    };\r\n    automationRules.push(newRule);\r\n  }\r\n\r\n  saveAutomationRules();\r\n  renderAutomationRules();\r\n  closeRuleEditor();\r\n}\r\n\r\nfunction handleEditRule(ruleId) {\r\n  openRuleEditor(ruleId);\r\n}\r\n\r\nfunction handleDeleteRule(ruleId) {\r\n  if (confirm('Tem certeza que deseja excluir esta regra?')) {\r\n    automationRules = automationRules.filter((r) => r.id !== ruleId);\r\n    saveAutomationRules();\r\n    renderAutomationRules();\r\n  }\r\n}\r\n\r\nfunction handleDuplicateRule(ruleId) {\r\n  const originalRule = automationRules.find((r) => r.id === ruleId);\r\n  if (!originalRule) return;\r\n\r\n  const newRule = JSON.parse(JSON.stringify(originalRule));\r\n  newRule.id = Date.now().toString();\r\n  newRule.name = `${originalRule.name} (Cópia)`;\r\n  newRule.isActive = false;\r\n\r\n  const originalIndex = automationRules.findIndex((r) => r.id === ruleId);\r\n  automationRules.splice(originalIndex + 1, 0, newRule);\r\n\r\n  saveAutomationRules();\r\n  renderAutomationRules();\r\n}\r\n\r\nfunction handleToggleRuleActive(ruleId, isActive) {\r\n  const ruleIndex = automationRules.findIndex((r) => r.id === ruleId);\r\n  if (ruleIndex > -1) {\r\n    automationRules[ruleIndex].isActive = isActive;\r\n    saveAutomationRules();\r\n  }\r\n}\r\n\r\nfunction reorderAutomationRules() {\r\n  const newOrderedIds = [\r\n    ...automationRulesList.querySelectorAll('.rule-item'),\r\n  ].map((item) => item.dataset.ruleId);\r\n  automationRules.sort(\r\n    (a, b) => newOrderedIds.indexOf(a.id) - newOrderedIds.indexOf(b.id)\r\n  );\r\n  saveAutomationRules();\r\n}\r\n\r\n/**\r\n * Popula as abas do editor de regras com os controles de filtro apropriados.\r\n */\r\nasync function populateRuleEditorFilters() {\r\n  let priorities = [];\r\n\r\n  try {\r\n    const baseUrl = await API.getBaseUrl();\r\n    if (baseUrl) {\r\n      priorities = await API.fetchRegulationPriorities();\r\n    }\r\n  } catch (error) {\r\n    console.error('Não foi possível carregar prioridades:', error);\r\n  }\r\n\r\n  const sections = [\r\n    'consultations',\r\n    'exams',\r\n    'appointments',\r\n    'regulations',\r\n    'documents',\r\n  ];\r\n\r\n  sections.forEach((sectionKey) => {\r\n    const container = document.getElementById(`${sectionKey}-rule-editor-tab`);\r\n    if (!container) return;\r\n    container.innerHTML = ''; // Limpa o conteúdo anterior\r\n\r\n    // Adiciona o componente de data\r\n    const dateRangeElement = createDateRangeElementForRuleEditor(sectionKey);\r\n    container.appendChild(dateRangeElement);\r\n\r\n    const sectionFilters = filterConfig[sectionKey] || [];\r\n\r\n    sectionFilters.forEach((filter) => {\r\n      if (filter.type === 'component') return;\r\n      const filterElement = createFilterElementForRuleEditor(\r\n        filter,\r\n        sectionKey,\r\n        priorities\r\n      );\r\n      container.appendChild(filterElement);\r\n    });\r\n  });\r\n\r\n  const firstTabButton = document.querySelector(\r\n    '#rule-editor-filter-tabs .tab-button'\r\n  );\r\n  if (firstTabButton) {\r\n    firstTabButton.click();\r\n  }\r\n}\r\n\r\n/**\r\n * Cria um único elemento de filtro para o modal do editor de regras.\r\n * @param {object} filter - O objeto de configuração do filtro.\r\n * @param {string} sectionKey - A chave da seção.\r\n * @param {Array<object>} priorities - A lista de prioridades dinâmicas.\r\n * @returns {HTMLElement} O elemento HTML do filtro.\r\n */\r\nfunction createFilterElementForRuleEditor(filter, sectionKey, priorities) {\r\n  const container = document.createElement('div');\r\n  const elementId = `rule-${sectionKey}-${filter.id}`;\r\n  let elementHtml = '';\r\n\r\n  if (filter.type !== 'checkbox') {\r\n    container.className = 'mb-3';\r\n    elementHtml += `<label for=\"${elementId}\" class=\"block font-medium mb-1 text-sm\">${filter.label}</label>`;\r\n  }\r\n\r\n  switch (filter.type) {\r\n  case 'text':\r\n    elementHtml += `<input type=\"text\" id=\"${elementId}\" placeholder=\"${\r\n      filter.placeholder || ''\r\n    }\" class=\"w-full px-2 py-1 border border-slate-300 rounded-md\">`;\r\n    break;\r\n  case 'select':\r\n  case 'selectGroup':\r\n    elementHtml += `<select id=\"${elementId}\" class=\"w-full px-2 py-1 border border-slate-300 rounded-md bg-white\">`;\r\n    if (filter.id === 'regulation-filter-priority') {\r\n      elementHtml += '<option value=\"todas\">Todas</option>';\r\n      priorities.forEach((prio) => {\r\n        elementHtml += `<option value=\"${prio.coreDescricao}\">${prio.coreDescricao}</option>`;\r\n      });\r\n    } else {\r\n      (filter.options || []).forEach((opt) => {\r\n        elementHtml += `<option value=\"${opt.value}\">${opt.text}</option>`;\r\n      });\r\n    }\r\n    elementHtml += '</select>';\r\n    break;\r\n  case 'checkbox':\r\n    container.className = 'flex items-center gap-2';\r\n    elementHtml += `<input id=\"${elementId}\" type=\"checkbox\" class=\"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500\">\r\n                          <label for=\"${elementId}\" class=\"block text-sm text-slate-700\">${filter.label}</label>`;\r\n    break;\r\n  }\r\n  container.innerHTML = elementHtml;\r\n  return container;\r\n}\r\n\r\n/**\r\n * Cria o componente de intervalo de datas para o editor de regras.\r\n * @param {string} sectionKey - A chave da seção.\r\n * @returns {HTMLElement} O elemento HTML do componente.\r\n */\r\nfunction createDateRangeElementForRuleEditor(sectionKey) {\r\n  const container = document.createElement('div');\r\n  container.className = 'p-2 bg-slate-50 rounded-md border mb-4';\r\n  container.innerHTML = `\r\n    <h5 class=\"font-medium text-xs text-slate-500 mb-2\">Período de Busca Automático</h5>\r\n    <div class=\"flex items-center gap-4 text-sm\">\r\n        <div>\r\n            <label for=\"rule-${sectionKey}-start-offset\" class=\"text-xs\">Início (meses antes):</label>\r\n            <input type=\"number\" id=\"rule-${sectionKey}-start-offset\" class=\"w-20 p-1 border rounded-md rule-date-range-input\" placeholder=\"Padrão\" min=\"0\">\r\n        </div>\r\n        <div>\r\n            <label for=\"rule-${sectionKey}-end-offset\" class=\"text-xs\">Fim (meses depois):</label>\r\n            <input type=\"number\" id=\"rule-${sectionKey}-end-offset\" class=\"w-20 p-1 border rounded-md rule-date-range-input\" placeholder=\"Padrão\" min=\"0\">\r\n        </div>\r\n    </div>\r\n    <p class=\"text-xs text-slate-400 mt-2\">Deixe em branco para usar o padrão global da seção.</p>\r\n  `;\r\n  return container;\r\n}\r\n\r\n// --- Inicialização ---\r\ndocument.addEventListener('DOMContentLoaded', async () => {\r\n  await restoreOptions();\r\n\r\n  const mainTabsContainer = document.querySelector(\r\n    '#filter-tabs-container .tabs'\r\n  );\r\n  Utils.setupTabs(document.getElementById('filter-tabs-container'));\r\n  if (mainTabsContainer) {\r\n    setupTabDnD(mainTabsContainer);\r\n  }\r\n  Utils.setupTabs(document.getElementById('rule-editor-filter-tabs'));\r\n\r\n  createNewRuleBtn.addEventListener('click', () => openRuleEditor(null));\r\n  cancelRuleBtn.addEventListener('click', closeRuleEditor);\r\n  saveRuleBtn.addEventListener('click', handleSaveRule);\r\n\r\n  ruleEditorModal.addEventListener('click', (e) => {\r\n    if (e.target === ruleEditorModal) {\r\n      closeRuleEditor();\r\n    }\r\n  });\r\n\r\n  automationRulesList.addEventListener('dragstart', handleDragStart);\r\n  automationRulesList.addEventListener('dragend', handleDragEnd);\r\n  automationRulesList.addEventListener('dragover', handleDragOver);\r\n  automationRulesList.addEventListener('drop', handleDrop);\r\n\r\n  browser.storage.onChanged.addListener((changes, areaName) => {\r\n    if (areaName === 'sync' && changes.enableAutomaticDetection) {\r\n      const toggle = document.getElementById('enableAutomaticDetection');\r\n      if (toggle) {\r\n        toggle.checked = changes.enableAutomaticDetection.newValue;\r\n      }\r\n    }\r\n  });\r\n});\r\n\r\nsaveButton.addEventListener('click', saveOptions);\r\ncloseButton.addEventListener('click', () => {\r\n  window.close();\r\n});\r\nrestoreDefaultsButton.addEventListener('click', handleRestoreDefaults);\r\nexportButton.addEventListener('click', handleExport);\r\nimportFileInput.addEventListener('change', handleImport);\r\n\r\nallDropZones.forEach((zone) => {\r\n  zone.addEventListener('dragover', handleDragOver);\r\n  zone.addEventListener('drop', handleDrop);\r\n});\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t\"options\": 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkassistente_de_regulacao_medica\"] = self[\"webpackChunkassistente_de_regulacao_medica\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [\"common\"], () => (__webpack_require__(\"./options.js\")))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n",""],"names":["API","defaultFieldConfig","filterConfig","Utils","CONFIG_VERSION","automationRules","currentlyEditingRuleId","draggedTab","saveButton","document","getElementById","statusMessage","closeButton","restoreDefaultsButton","exportButton","importFileInput","mainFieldsZone","moreFieldsZone","allDropZones","querySelectorAll","automationRulesList","createNewRuleBtn","ruleEditorModal","ruleEditorTitle","ruleNameInput","ruleTriggersInput","cancelRuleBtn","saveRuleBtn","createDraggableField","field","div","createElement","className","dataset","fieldId","id","draggable","innerHTML","enabled","label","addEventListener","handleDragStart","handleDragEnd","createDraggableFilter","filter","priorities","filterId","displayType","type","defaultValueControl","optionsHtml","options","map","opt","value","text","join","forEach","prio","coreDescricao","replace","classList","add","renderPatientFields","config","sortedConfig","sort","a","b","order","fieldElement","section","appendChild","renderFilterLayout","layout","baseUrl","getBaseUrl","fetchRegulationPriorities","error","console","Object","keys","mainZone","moreZone","entries","sectionKey","filters","sectionLayout","layoutMap","Map","f","sortedFilters","_layoutMap$get$order","_layoutMap$get","_layoutMap$get$order2","_layoutMap$get2","orderA","get","Infinity","orderB","filterLayoutData","location","defaultLocation","zoneId","zone","filterElement","defaultValue","undefined","defaultValueInput","querySelector","checked","applyTabOrder","tabsContainer","tabMap","tab","set","tabId","tabElement","restoreOptions","syncItems","browser","storage","sync","autoLoadExams","autoLoadConsultations","autoLoadAppointments","autoLoadRegulations","autoLoadDocuments","enableAutomaticDetection","keepSessionAliveInterval","patientFields","filterLayout","dateRangeDefaults","sidebarSectionOrder","sectionHeaderStyles","localItems","local","currentPatientFieldsConfig","defaultField","savedField","find","sections","defaultRanges","consultations","start","end","exams","appointments","regulations","documents","defaultStyles","backgroundColor","color","iconColor","fontSize","range","startOffsetEl","endOffsetEl","Math","abs","savedStyle","style","bgColorEl","fontColorEl","iconColorEl","fontSizeEl","renderAutomationRules","saveOptions","parseInt","index","push","includes","originalFilter","newFilterData","sectionsForDate","startEl","endEl","sectionsForStyle","btn","endsWith","slice","showMessage","setTimeout","statusMsg","textContent","draggedElement","e","target","closest","dataTransfer","effectAllowed","remove","handleDragOver","preventDefault","dropEffect","handleDrop","dropZone","afterElement","getDragAfterElement","clientY","insertBefore","reorderAutomationRules","container","y","draggableElements","reduce","child","box","getBoundingClientRect","offset","top","height","element","Number","NEGATIVE_INFINITY","getDragAfterTab","x","left","width","setupTabDnD","tabs","contains","clientX","handleRestoreDefaults","confirmation","window","confirm","reload","handleExport","settingsToExport","configVersion","settingsString","JSON","stringify","blob","Blob","url","URL","createObjectURL","href","date","Date","toISOString","download","body","click","removeChild","revokeObjectURL","handleImport","event","file","files","reader","FileReader","onload","importedSettings","parse","result","Error","split","goOn","clear","message","readAsText","rule","ruleElement","ruleId","keywords","triggerKeywords","isActive","name","length","substring","item","handleEditRule","handleDeleteRule","handleDuplicateRule","handleToggleRuleActive","saveAutomationRules","openRuleEditor","populateRuleEditorFilters","r","filterSettings","dateRange","isNaN","el","closeRuleEditor","handleSaveRule","trim","alert","k","Boolean","startVal","endVal","startNum","endNum","sectionFilters","ruleIndex","findIndex","newRule","now","toString","originalRule","originalIndex","splice","newOrderedIds","indexOf","dateRangeElement","createDateRangeElementForRuleEditor","createFilterElementForRuleEditor","firstTabButton","elementId","elementHtml","placeholder","mainTabsContainer","setupTabs","onChanged","addListener","changes","areaName","toggle","newValue","close"],"sourceRoot":""}