(()=>{"use strict";var e,t={239:(e,t,n)=>{function o({message:e,onConfirm:t,onCancel:n}){let o=document.getElementById("custom-confirm-modal");o||(o=document.createElement("div"),o.id="custom-confirm-modal",o.innerHTML='\n      <div class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50">\n        <div class="bg-white rounded-lg shadow-lg p-6 max-w-md w-full">\n          <div class="mb-4 text-slate-800 text-base" id="custom-confirm-message"></div>\n          <div class="flex justify-end gap-2">\n            <button id="custom-confirm-cancel" class="px-4 py-2 rounded bg-slate-200 text-slate-700 hover:bg-slate-300">Cancelar</button>\n            <button id="custom-confirm-ok" class="px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700">Confirmar</button>\n          </div>\n        </div>\n      </div>\n    ',document.body.appendChild(o)),o.style.display="flex",o.querySelector("#custom-confirm-message").textContent=e;const a=o.querySelector("#custom-confirm-ok"),r=o.querySelector("#custom-confirm-cancel"),s=()=>{o.style.display="none"};a.onclick=()=>{s(),t&&t()},r.onclick=()=>{s(),n&&n()}}function a(e,t="error"){const n=document.getElementById("message-area");if(n){n.textContent=e;const o={error:"bg-red-100 text-red-700",success:"bg-green-100 text-green-700",info:"bg-blue-100 text-blue-700"};n.className=`p-3 rounded-md text-sm ${o[t]||o.error}`,n.style.display="block"}}n.d(t,{AQ:()=>r,rG:()=>a,ui:()=>o});function r(e){if(!e)return;const t=e.querySelectorAll(".tab-button"),n=e.querySelectorAll(".tab-content");t.forEach(o=>{o.addEventListener("click",()=>{const a=o.dataset.tab;t.forEach(e=>e.classList.remove("active")),n.forEach(e=>e.classList.remove("active")),o.classList.add("active");const r=e.querySelector(`#${a}-tab`);r&&r.classList.add("active")})})}},640:(e,t,n)=>{var o=n(574),a=n(869),r=n(733),s=n(239);const l=window.browser||window.chrome;let c=[],d=null,i=null;const u=document.getElementById("saveButton"),m=document.getElementById("statusMessage"),f=document.getElementById("closeButton"),g=document.getElementById("restoreDefaultsButton"),p=document.getElementById("exportButton"),b=document.getElementById("import-file-input"),y=document.getElementById("main-fields-zone"),v=document.getElementById("more-fields-zone"),h=document.querySelectorAll(".drop-zone"),E=document.getElementById("automation-rules-list"),x=document.getElementById("create-new-rule-btn"),I=document.getElementById("rule-editor-modal"),k=document.getElementById("rule-editor-title"),L=document.getElementById("rule-name-input"),$=document.getElementById("rule-triggers-input"),B=document.getElementById("cancel-rule-btn"),w=document.getElementById("save-rule-btn");function S(e){y.innerHTML="",v.innerHTML="";[...e].sort((e,t)=>e.order-t.order).forEach(e=>{const t=function(e){const t=document.createElement("div");return t.className="draggable",t.dataset.fieldId=e.id,t.draggable=!0,t.innerHTML=`\n    <span class="drag-handle">⠿</span>\n    <input type="checkbox" class="field-enabled-checkbox" ${e.enabled?"checked":""}>\n    <input type="text" class="field-label-input" value="${e.label}">\n  `,t.addEventListener("dragstart",D),t.addEventListener("dragend",N),t}(e);"main"===e.section?y.appendChild(t):v.appendChild(t)})}async function C(e){let t=[];try{await o.$_()&&(t=await o.$4())}catch(n){}Object.keys(r.J).forEach(e=>{const t=document.getElementById(`${e}-main-filters-zone`),n=document.getElementById(`${e}-more-filters-zone`);t&&(t.innerHTML=""),n&&(n.innerHTML="")}),Object.entries(r.J).forEach(([n,o])=>{const a=e[n]||[],r=new Map(a.map(e=>[e.id,e]));[...o].sort((e,t)=>{var n,o,a,s;return(null!==(n=null===(o=r.get(e.id))||void 0===o?void 0:o.order)&&void 0!==n?n:1/0)-(null!==(a=null===(s=r.get(t.id))||void 0===s?void 0:s.order)&&void 0!==a?a:1/0)}).forEach(e=>{const o=r.get(e.id),a=(null==o?void 0:o.location)||e.defaultLocation;if("patient-card"===n)return;const s=`${n}-${a}-filters-zone`,l=document.getElementById(s);if(l){const n=function(e,t=[]){const n=document.createElement("div");n.className="draggable",n.dataset.filterId=e.id,n.draggable=!0;const o="selectGroup"===e.type?"select":e.type;let a="";if("component"!==e.type)switch(e.type){case"text":a='<input type="text" class="filter-default-value-input w-full" placeholder="Valor padrão...">';break;case"select":case"selectGroup":{let n="";"regulation-filter-priority"===e.id?(n=e.options.map(e=>`<option value="${e.value}">${e.text}</option>`).join(""),t.forEach(e=>{n+=`<option value="${e.coreDescricao}">${e.coreDescricao}</option>`})):n=(e.options||[]).map(e=>`<option value="${e.value}">${e.text}</option>`).join(""),a=`<select class="filter-default-value-input w-full">${n}</select>`;break}case"checkbox":a='<input type="checkbox" class="filter-default-value-input h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500">'}return n.innerHTML=`\n    <span class="drag-handle">⠿</span>\n    <div class="flex-grow flex flex-col gap-2">\n        <div class="flex justify-between items-center">\n            <span class="font-medium text-sm">${e.label}</span>\n            <span class="text-xs text-slate-400 p-1 bg-slate-100 rounded">${o}</span>\n        </div>\n        ${a?`\n        <div class="flex items-center gap-2 text-xs text-slate-500">\n            <label for="default-${e.id}">Padrão:</label>\n            ${a.replace('class="',`id="default-${e.id}" class="`)}\n        </div>`:""}\n    </div>\n  `,"component"===e.type&&n.classList.add("draggable-component"),n.addEventListener("dragstart",D),n.addEventListener("dragend",N),n}(e,t);if(l.appendChild(n),"component"!==e.type&&o&&void 0!==o.defaultValue){const e=n.querySelector(".filter-default-value-input");e&&("checkbox"===e.type?e.checked=o.defaultValue:e.value=o.defaultValue)}}})})}async function A(){const e=await l.storage.sync.get({baseUrl:"",autoLoadExams:!1,autoLoadConsultations:!1,autoLoadAppointments:!1,autoLoadRegulations:!1,autoLoadDocuments:!1,enableAutomaticDetection:!0,keepSessionAliveInterval:10,patientFields:a.Q,filterLayout:{},dateRangeDefaults:{},sidebarSectionOrder:null,sectionHeaderStyles:{}}),t=await l.storage.local.get({automationRules:[]});document.getElementById("baseUrlInput").value=e.baseUrl||"",document.getElementById("enableAutomaticDetection").checked=e.enableAutomaticDetection,document.getElementById("keepSessionAliveInterval").value=e.keepSessionAliveInterval,document.getElementById("autoLoadExamsCheckbox").checked=e.autoLoadExams,document.getElementById("autoLoadConsultationsCheckbox").checked=e.autoLoadConsultations,document.getElementById("autoLoadAppointmentsCheckbox").checked=e.autoLoadAppointments,document.getElementById("autoLoadRegulationsCheckbox").checked=e.autoLoadRegulations,document.getElementById("autoLoadDocumentsCheckbox").checked=e.autoLoadDocuments,e.sidebarSectionOrder&&function(e){const t=document.querySelector("#filter-tabs-container .tabs");if(!t)return;const n=new Map;t.querySelectorAll(".tab-button").forEach(e=>{n.set(e.dataset.tab,e)}),e.forEach(e=>{const o=n.get(e);o&&t.appendChild(o)})}(e.sidebarSectionOrder);S(a.Q.map(t=>{const n=e.patientFields.find(e=>e.id===t.id);return n?{...t,...n}:t}));try{await C(e.filterLayout)}catch(r){}const n={consultations:{start:-6,end:0},exams:{start:-6,end:0},appointments:{start:-1,end:3},regulations:{start:-12,end:0},documents:{start:-24,end:0}},o={backgroundColor:"#ffffff",color:"#1e293b",iconColor:"#1e293b",fontSize:"16px"};["patient-details","timeline","consultations","exams","appointments","regulations","documents"].forEach(t=>{if(n[t]){const o=e.dateRangeDefaults[t]||n[t],a=document.getElementById(`${t}-start-offset`),r=document.getElementById(`${t}-end-offset`);a&&(a.value=Math.abs(o.start)),r&&(r.value=o.end)}const a=e.sectionHeaderStyles[t]||{},r={...o,...a},s=document.getElementById(`style-${t}-bg-color`),l=document.getElementById(`style-${t}-font-color`),c=document.getElementById(`style-${t}-icon-color`),d=document.getElementById(`style-${t}-font-size`);s&&(s.value=r.backgroundColor),l&&(l.value=r.color),c&&(c.value=r.iconColor),d&&(d.value=r.fontSize)}),c=t.automationRules||[],j()}let q=null;function D(e){q=e.target.closest(".draggable, .rule-item"),q&&(e.dataTransfer.effectAllowed="move",setTimeout(()=>q.classList.add("dragging"),0))}function N(){q&&(q.classList.remove("dragging"),q=null)}function O(e){e.preventDefault(),e.dataTransfer.dropEffect="move"}function T(e){if(e.preventDefault(),!q)return;const t=e.target.closest(".drop-zone, #automation-rules-list");if(t){const a=(n=t,o=e.clientY,[...n.querySelectorAll(".draggable:not(.dragging), .rule-item:not(.dragging)")].reduce((e,t)=>{const n=t.getBoundingClientRect(),a=o-n.top-n.height/2;return a<0&&a>e.offset?{offset:a,element:t}:e},{offset:Number.NEGATIVE_INFINITY}).element);null==a?t.appendChild(q):t.insertBefore(q,a),"automation-rules-list"===t.id&&function(){const e=[...E.querySelectorAll(".rule-item")].map(e=>e.dataset.ruleId);c.sort((t,n)=>e.indexOf(t.id)-e.indexOf(n.id)),M()}()}var n,o}function R(e){if(!e)return;e.querySelectorAll(".tab-button").forEach(e=>{"patient-card"!==e.dataset.tab&&(e.draggable=!0)}),e.addEventListener("dragstart",e=>{e.target.classList.contains("tab-button")&&e.target.draggable&&(i=e.target,setTimeout(()=>e.target.classList.add("dragging"),0))}),e.addEventListener("dragend",()=>{i&&(i.classList.remove("dragging"),i=null)}),e.addEventListener("dragover",t=>{if(t.preventDefault(),!i)return;const n=function(e,t){return[...e.querySelectorAll(".tab-button:not(.dragging)")].reduce((e,n)=>{const o=n.getBoundingClientRect(),a=t-o.left-o.width/2;return a<0&&a>e.offset&&n.draggable?{offset:a,element:n}:e},{offset:Number.NEGATIVE_INFINITY}).element}(e,t.clientX);n?e.insertBefore(i,n):e.appendChild(i)})}function j(){E.innerHTML="",c.forEach(e=>{const t=document.createElement("div");t.className="rule-item border rounded-lg bg-white p-3",t.dataset.ruleId=e.id,t.draggable=!0;const n=e.triggerKeywords.join(", "),o=e.isActive?"checked":"";t.innerHTML=`\n            <div class="flex items-center justify-between">\n              <div class="flex items-center gap-3">\n                <span class="drag-handle cursor-grab text-slate-400">⠿</span>\n                <div>\n                  <p class="font-semibold text-slate-800">${e.name}</p>\n                  <p class="text-xs text-slate-500" title="${n}">Gatilhos: ${n.length>50?n.substring(0,50)+"...":n}</p>\n                </div>\n              </div>\n              <div class="flex items-center gap-4">\n                <label class="relative inline-flex items-center cursor-pointer" title="${e.isActive?"Regra Ativa":"Regra Inativa"}">\n                  <input type="checkbox" class="sr-only peer rule-toggle-active" ${o}>\n                  <div class="w-11 h-6 bg-gray-200 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>\n                </label>\n                <button class="text-sm font-medium text-blue-600 hover:underline rule-edit-btn">Editar</button>\n                <button class="text-sm font-medium text-slate-500 hover:underline rule-duplicate-btn">Duplicar</button>\n                <button class="text-sm font-medium text-red-600 hover:underline rule-delete-btn">Excluir</button>\n              </div>\n            </div>\n        `,E.appendChild(t)}),document.querySelectorAll(".rule-item").forEach(e=>{const t=e.dataset.ruleId;e.querySelector(".rule-edit-btn").addEventListener("click",()=>function(e){H(e)}(t)),e.querySelector(".rule-delete-btn").addEventListener("click",()=>function(e){s.ui({message:"Tem certeza que deseja excluir esta regra?",onConfirm:()=>{c=c.filter(t=>t.id!==e),M(),j()}})}(t)),e.querySelector(".rule-duplicate-btn").addEventListener("click",()=>function(e){const t=c.find(t=>t.id===e);if(!t)return;const n=JSON.parse(JSON.stringify(t));n.id=Date.now().toString(),n.name=`${t.name} (Cópia)`,n.isActive=!1;const o=c.findIndex(t=>t.id===e);c.splice(o+1,0,n),M(),j()}(t)),e.querySelector(".rule-toggle-active").addEventListener("change",e=>function(e,t){const n=c.findIndex(t=>t.id===e);n>-1&&(c[n].isActive=t,M())}(t,e.target.checked))})}async function M(){await l.storage.local.set({automationRules:c}),s.rG("Regras de automação salvas.","success"),setTimeout(()=>{m.textContent=""},2e3)}async function H(e=null){if(d=e,await async function(){let e=[];try{await o.$_()&&(e=await o.$4())}catch(n){}["consultations","exams","appointments","regulations","documents"].forEach(t=>{const n=document.getElementById(`${t}-rule-editor-tab`);if(!n)return;n.innerHTML="";const o=function(e){const t=document.createElement("div");return t.className="p-2 bg-slate-50 rounded-md border mb-4",t.innerHTML=`\n    <h5 class="font-medium text-xs text-slate-500 mb-2">Período de Busca Automático</h5>\n    <div class="flex items-center gap-4 text-sm">\n        <div>\n            <label for="rule-${e}-start-offset" class="text-xs">Início (meses antes):</label>\n            <input type="number" id="rule-${e}-start-offset" class="w-20 p-1 border rounded-md rule-date-range-input" placeholder="Padrão" min="0">\n        </div>\n        <div>\n            <label for="rule-${e}-end-offset" class="text-xs">Fim (meses depois):</label>\n            <input type="number" id="rule-${e}-end-offset" class="w-20 p-1 border rounded-md rule-date-range-input" placeholder="Padrão" min="0">\n        </div>\n    </div>\n    <p class="text-xs text-slate-400 mt-2">Deixe em branco para usar o padrão global da seção.</p>\n  `,t}(t);n.appendChild(o);(r.J[t]||[]).forEach(o=>{if("component"===o.type)return;const a=function(e,t,n){const o=document.createElement("div"),a=`rule-${t}-${e.id}`;let r="";"checkbox"!==e.type&&(o.className="mb-3",r+=`<label for="${a}" class="block font-medium mb-1 text-sm">${e.label}</label>`);switch(e.type){case"text":r+=`<input type="text" id="${a}" placeholder="${e.placeholder||""}" class="w-full px-2 py-1 border border-slate-300 rounded-md">`;break;case"select":case"selectGroup":r+=`<select id="${a}" class="w-full px-2 py-1 border border-slate-300 rounded-md bg-white">`,"regulation-filter-priority"===e.id?(r+='<option value="todas">Todas</option>',n.forEach(e=>{r+=`<option value="${e.coreDescricao}">${e.coreDescricao}</option>`})):(e.options||[]).forEach(e=>{r+=`<option value="${e.value}">${e.text}</option>`}),r+="</select>";break;case"checkbox":o.className="flex items-center gap-2",r+=`<input id="${a}" type="checkbox" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500">\n                          <label for="${a}" class="block text-sm text-slate-700">${e.label}</label>`}return o.innerHTML=r,o}(o,t,e);n.appendChild(a)})});const t=document.querySelector("#rule-editor-filter-tabs .tab-button");t&&t.click()}(),e){const t=c.find(t=>t.id===e);if(!t)return;k.textContent="Editar Regra de Automação",L.value=t.name,$.value=t.triggerKeywords.join(", "),Object.entries(t.filterSettings).forEach(([e,t])=>{if(t&&t.dateRange){const{start:n,end:o}=t.dateRange,a=document.getElementById(`rule-${e}-start-offset`),r=document.getElementById(`rule-${e}-end-offset`);a&&null!==n&&!isNaN(n)?a.value=Math.abs(n):a&&(a.value=""),r&&null!==o&&!isNaN(o)?r.value=o:r&&(r.value="")}Object.entries(t).forEach(([t,n])=>{if("dateRange"===t)return;const o=document.getElementById(`rule-${e}-${t}`);o&&("checkbox"===o.type?o.checked=n:o.value=n)})})}else{k.textContent="Criar Nova Regra de Automação",L.value="",$.value="";["consultations","exams","appointments","regulations","documents"].forEach(e=>{const t=document.getElementById(`rule-${e}-start-offset`),n=document.getElementById(`rule-${e}-end-offset`);t&&(t.value=""),n&&(n.value="")}),document.querySelectorAll('#rule-editor-modal input[type="text"]:not(.rule-date-range-input), #rule-editor-modal input[type="search"]:not(.rule-date-range-input)').forEach(e=>e.value=""),document.querySelectorAll('#rule-editor-modal input[type="checkbox"]').forEach(e=>e.checked=!1),document.querySelectorAll("#rule-editor-modal select").forEach(e=>{e.options.length>0&&(e.value=e.options[0].value)})}I.classList.remove("hidden")}function z(){I.classList.add("hidden"),d=null}function G(){const e=L.value.trim();if(!e)return void s.rG("O nome da regra é obrigatório.","error");const t=$.value.split(",").map(e=>e.trim()).filter(Boolean),n={};if(["consultations","exams","appointments","regulations","documents"].forEach(e=>{n[e]={};const t=document.getElementById(`rule-${e}-start-offset`),o=document.getElementById(`rule-${e}-end-offset`),a=t.value,s=o.value,l=parseInt(a,10),c=parseInt(s,10);isNaN(l)&&isNaN(c)||(n[e].dateRange={start:isNaN(l)?null:-l,end:isNaN(c)?null:c});(r.J[e]||[]).forEach(t=>{if("component"===t.type)return;const o=document.getElementById(`rule-${e}-${t.id}`);if(o){const a="checkbox"===o.type?o.checked:o.value;n[e][t.id]=a}})}),d){const o=c.findIndex(e=>e.id===d);o>-1&&(c[o].name=e,c[o].triggerKeywords=t,c[o].filterSettings=n)}else{const o={id:Date.now().toString(),name:e,triggerKeywords:t,isActive:!0,filterSettings:n};c.push(o)}M(),j(),z()}document.addEventListener("DOMContentLoaded",async()=>{await A();const e=document.querySelector("#filter-tabs-container .tabs");s.AQ(document.getElementById("filter-tabs-container")),e&&R(e),s.AQ(document.getElementById("rule-editor-filter-tabs")),x.addEventListener("click",()=>H(null)),B.addEventListener("click",z),w.addEventListener("click",G),I.addEventListener("click",e=>{e.target===I&&z()}),E.addEventListener("dragstart",D),E.addEventListener("dragend",N),E.addEventListener("dragover",O),E.addEventListener("drop",T),l.storage.onChanged.addListener((e,t)=>{if("sync"===t&&e.enableAutomaticDetection){const t=document.getElementById("enableAutomaticDetection");t&&(t.checked=e.enableAutomaticDetection.newValue)}})}),u.addEventListener("click",async function(){const e=document.getElementById("baseUrlInput").value,t=document.getElementById("enableAutomaticDetection").checked,n=parseInt(document.getElementById("keepSessionAliveInterval").value,10)||0,o=document.getElementById("autoLoadExamsCheckbox").checked,a=document.getElementById("autoLoadConsultationsCheckbox").checked,c=document.getElementById("autoLoadAppointmentsCheckbox").checked,d=document.getElementById("autoLoadRegulationsCheckbox").checked,i=document.getElementById("autoLoadDocumentsCheckbox").checked,u=[];y.querySelectorAll(".draggable").forEach((e,t)=>{const n=e.dataset.fieldId,o=e.querySelector(".field-label-input").value,a=e.querySelector(".field-enabled-checkbox").checked;u.push({id:n,label:o,enabled:a,section:"main",order:t+1})}),v.querySelectorAll(".draggable").forEach((e,t)=>{const n=e.dataset.fieldId,o=e.querySelector(".field-label-input").value,a=e.querySelector(".field-enabled-checkbox").checked;u.push({id:n,label:o,enabled:a,section:"more",order:t+1})});const m={};document.querySelectorAll("#layout-config-section .drop-zone").forEach(e=>{if(!e.dataset.section)return;const t=e.dataset.section;m[t]||(m[t]=[]);const n=e.id.includes("-main-")?"main":"more";e.querySelectorAll(".draggable").forEach((e,o)=>{const a=e.dataset.filterId,s=r.J[t].find(e=>e.id===a),l={id:a,location:n,order:o+1};if("component"!==s.type){const t=e.querySelector(".filter-default-value-input");t&&(l.defaultValue="checkbox"===t.type?t.checked:t.value)}m[t].push(l)})});const f={};["consultations","exams","appointments","regulations","documents"].forEach(e=>{const t=document.getElementById(`${e}-start-offset`),n=document.getElementById(`${e}-end-offset`);if(t&&n){const o=-parseInt(t.value,10)||0,a=parseInt(n.value,10)||0;f[e]={start:o,end:a}}});const g={};["patient-details","timeline","consultations","exams","appointments","regulations","documents"].forEach(e=>{const t=document.getElementById(`style-${e}-bg-color`);t&&(g[e]={backgroundColor:t.value,color:document.getElementById(`style-${e}-font-color`).value,iconColor:document.getElementById(`style-${e}-icon-color`).value,fontSize:document.getElementById(`style-${e}-font-size`).value})});const p=[...document.querySelectorAll(".tabs .tab-button")].map(e=>e.dataset.tab);await l.storage.sync.set({baseUrl:e.endsWith("/")?e.slice(0,-1):e,enableAutomaticDetection:t,keepSessionAliveInterval:n,autoLoadExams:o,autoLoadConsultations:a,autoLoadAppointments:c,autoLoadRegulations:d,autoLoadDocuments:i,patientFields:u,filterLayout:m,dateRangeDefaults:f,sidebarSectionOrder:p,sectionHeaderStyles:g}),s.rG("Configurações salvas! As alterações serão aplicadas ao recarregar o assistente.","success"),setTimeout(()=>{const e=document.getElementById("statusMessage");e&&(e.textContent="",e.className="text-sm font-medium")},4e3)}),f.addEventListener("click",()=>{window.close()}),g.addEventListener("click",async function(){s.ui({message:"Tem certeza de que deseja restaurar todas as configurações de layout e valores padrão? Isto também restaurará a ordem das seções e os estilos dos cabeçalhos. Esta ação não pode ser desfeita.",onConfirm:async()=>{await l.storage.sync.remove(["patientFields","filterLayout","dateRangeDefaults","enableAutomaticDetection","sidebarSectionOrder","sectionHeaderStyles"]),y.innerHTML="",v.innerHTML="",window.location.reload()}})}),p.addEventListener("click",async function(){try{const e=await l.storage.sync.get(null);e.configVersion="1.3";const t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json"}),o=URL.createObjectURL(n),a=document.createElement("a");a.href=o;const r=(new Date).toISOString().slice(0,10);a.download=`assistente-regulacao-config-${r}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o),s.rG("Configurações exportadas com sucesso!","success")}catch(e){s.rG("Erro ao exportar configurações.","error")}finally{setTimeout(()=>{m.textContent=""},3e3)}}),b.addEventListener("change",function(e){const t=e.target.files[0];if(!t)return;const n=new FileReader;n.onload=async e=>{try{const t=JSON.parse(e.target.result);if(!t.configVersion||!t.filterLayout)throw new Error("Ficheiro de configuração inválido ou corrompido.");if(t.configVersion.split(".")[0]!=="1.3".split(".")[0])return void s.ui({message:"A versão do ficheiro de configuração é muito diferente da versão da extensão. A importação pode causar erros. Deseja continuar mesmo assim?",onConfirm:async()=>{await l.storage.sync.clear(),await l.storage.sync.set(t),A(),s.rG("Configurações importadas e aplicadas com sucesso!","success")}});await l.storage.sync.clear(),await l.storage.sync.set(t),A(),s.rG("Configurações importadas e aplicadas com sucesso!","success")}catch(t){s.rG(`Erro ao importar: ${t.message}`,"error")}finally{b.value="",setTimeout(()=>{m.textContent=""},5e3)}},n.readAsText(t)}),h.forEach(e=>{e.addEventListener("dragover",O),e.addEventListener("drop",T)})}},n={};function o(e){var a=n[e];if(void 0!==a)return a.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,o),r.exports}o.m=t,e=[],o.O=(t,n,a,r)=>{if(!n){var s=1/0;for(i=0;i<e.length;i++){for(var[n,a,r]=e[i],l=!0,c=0;c<n.length;c++)(!1&r||s>=r)&&Object.keys(o.O).every(e=>o.O[e](n[c]))?n.splice(c--,1):(l=!1,r<s&&(s=r));if(l){e.splice(i--,1);var d=a();void 0!==d&&(t=d)}}return t}r=r||0;for(var i=e.length;i>0&&e[i-1][2]>r;i--)e[i]=e[i-1];e[i]=[n,a,r]},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.j=575,(()=>{var e={575:0,738:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var a,r,[s,l,c]=n,d=0;if(s.some(t=>0!==e[t])){for(a in l)o.o(l,a)&&(o.m[a]=l[a]);if(c)var i=c(o)}for(t&&t(n);d<s.length;d++)r=s[d],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(i)},n=self.webpackChunkassistente_de_regulacao_medica=self.webpackChunkassistente_de_regulacao_medica||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=o.O(void 0,[76],()=>o(640));a=o.O(a)})();